<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Learning Android &#8211; EK</title>
<meta name="description" content="Playing with Android OS

">
<meta name="keywords" content="android, linux">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Learning Android">
<meta name="twitter:description" content="Playing with Android OS

">
<meta name="twitter:site" content="@jivoi">
<meta name="twitter:creator" content="@jivoi">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jivoi.github.io/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_GB">
<meta property="og:type" content="article">
<meta property="og:title" content="Learning Android">
<meta property="og:description" content="Playing with Android OS

">
<meta property="og:url" content="https://jivoi.github.io/2015/07/17/learning-android/">
<meta property="og:site_name" content="EK">






<link rel="canonical" href="https://jivoi.github.io/2015/07/17/learning-android/">
<link href="https://jivoi.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="EK Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="https://jivoi.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="https://jivoi.github.io/assets/js/vendor/html5shiv.min.js"></script>
	<script src="https://jivoi.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="https://jivoi.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://jivoi.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://jivoi.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://jivoi.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://jivoi.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://jivoi.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://jivoi.github.io/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="https://jivoi.github.io/">EK</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="https://jivoi.github.io/archive/" >Archive</a></li>
				
				    
				        
				    
				    <li><a href="https://jivoi.github.io/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="https://jivoi.github.io/feed.xml" >Feed</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    



	<img src="https://jivoi.github.io/images/avatar.jpg" class="bio-photo" alt="EK bio photo">

<h3>EK</h3>
<p>Totally not a hacker</p>
<a href="mailto:ekoz@protonmail.com" class="author-widgets" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
<a href="http://twitter.com/jivoi" class="author-widgets" target="_blank"><i class="fa fa-fw fa-tw-square"></i> Twitter</a>





<a href="http://github.com/jivoi" class="author-widgets" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>










  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="https://jivoi.github.io/2015/07/17/learning-android/" rel="bookmark" title="Learning Android">Learning Android</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>Playing with Android OS</p>

<h3 id="list-of-usefull-software-applications">List of usefull software applications:</h3>
<ul>
  <li><a href="https://developer.android.com/sdk/index.html">Android SDK</a></li>
  <li><a href="https://code.google.com/p/android-apktool/downloads/list">APKTool</a></li>
  <li><a href="http://jd.benow.ca/">JD-GUI</a></li>
  <li><a href="https://github.com/pxb1988/dex2jar">Dex2Jar</a></li>
  <li><a href="http://portswigger.net/burp/download.html">Burp Proxy</a></li>
  <li><a href="http://android.saz.lt/cgi-bin/download.py">Andriller</a></li>
  <li><a href="http://python.org/download/releases/3.0/">Python 3.0</a></li>
  <li><a href="https://github.com/viaforensics/android-forensics">AFLogical</a></li>
  <li><a href="https://github.com/sqlitebrowser/sqlitebrowser">SQLite Browser</a></li>
  <li><a href="https://www.mwrinfosecurity.com/products/drozer/community-edition/">Drozer</a></li>
</ul>

<h3 id="links">Links</h3>
<ul>
  <li><a href="https://mobilesecuritywiki.com/">https://mobilesecuritywiki.com/</a></li>
  <li><a href="https://manifestsecurity.com/">https://manifestsecurity.com/</a></li>
</ul>

<p><img src="http://elinux.org/images/c/c2/Android-system-architecture.jpg" /></p>

<p>The architecture of Android is divided into four different layers.
At the bottom of it sits the Linux kernel, which has been modified for better performance in a mobile environment.</p>

<p>On top of Linux kernel sits a layer that contains some of the most important and useful libraries as follows:</p>

<ul>
  <li>Surface Manager: This manages the windows and screens</li>
  <li>Media Framework: This allows the use of various types of codecs for playback and recording of different media</li>
  <li>SQLite: This is a lighter version of SQL used for database management</li>
  <li>WebKit: This is the browser rendering engine</li>
  <li>OpenGL: This is used to render 2D and 3D contents on the screen properly</li>
</ul>

<p>No libc, Android has its own library called bionic, which we could think of as a stripped down and modified version of libc for Android. All the applications in Android run under a virtual environment, which is called Dalvik Virtual Machine (DVM). An important point to note here is that from Android Version 4.4, there is also the availability of another runtime called Android Runtime (ART), and the user is free to switch between the DVM and the ART
runtime environments.</p>

<p>Dalvik Virtual Machine is similar to Java Virtual Machine (JVM), apart from features such as it is register-based, instead of stack-based. If we are running three different applications, there will be three different virtual instances. The Dalvik Virtual Machine executes a file format called .dex or Dalvik Executable.</p>

<h3 id="playing-with-android-debug-bridge-adb">Playing with Android Debug Bridge (ADB)</h3>
<p>Enable USB Debugging on your phone or device:
Go to Settings –&gt; About Phone tap “Build Number” until you get a popup that you have become a developer (about 10 times). Then go to Settings –&gt; Developer –&gt; USB debugging and enable it.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>adb devices
<span class="nv">$ </span>adb shell
<span class="nv">$ </span>shell@hammerhead:/ <span class="nv">$ </span>ps
<span class="nv">$ </span>adb devices
<span class="nv">$ </span>adb shell pm list packages
<span class="nv">$ </span>dumpsys meminfo
<span class="nv">$ </span>adb logcat -d -f /data/local/logcats.log

<span class="c"># print the properties of the device</span>
adb shell getprop

<span class="c"># pm to list all the packages</span>
adb shell pm list packages

<span class="c"># take a backup of any application we need</span>
adb backup <span class="o">[</span>package name<span class="o">]</span> -f <span class="o">[</span>destination file name<span class="o">]</span>
dd <span class="k">if</span><span class="o">=</span>aplication.ab <span class="nv">bs</span><span class="o">=</span><span class="m">24</span> <span class="nv">skip</span><span class="o">=</span><span class="m">1</span> <span class="p">|</span> openssl zlib -d &gt; application.tar
tar xzf application.tar

<span class="c"># dumping and analyze application databases manually</span>
the application files are stored at  /data/data/<span class="o">[</span>application package name<span class="o">]</span>/
find /data/data/* -name <span class="s2">&quot;*.db&quot;</span> -type f
find /data/data/* -name <span class="s2">&quot;*.db&quot;</span> -type f -exec cp <span class="o">{}</span> /mnt/sdcard/BackupDBS <span class="se">\;</span>

<span class="c"># run avd from cli</span>
<span class="nv">$ </span>emulator -avd <span class="o">[</span>name of the avd<span class="o">]</span> -http-proxy 127.0.0.1:808</code></pre></div>

<p>Every time a new application is initiated in the Android device, it is assigned a unique User ID (UID), which will further belong to some or the other group that is pre-defined. The groups and the permissions inside it are specified in the file in our device named  platform.xml located at  /system/etc/permissions/.</p>

<p>The applications data that we install from the Play Store or any other source will be located at  /data/data , whereas their original installation file, that is, .apk will be stored at  /data/app. Also, there are some applications that need to be purchased from the Play Store instead of just downloading it for free. These applications will be stored at  /data/app-private/. To list this dir you need to be a root. Rooting a device means we have full access and control over the entire device, which means we could see as well as modify any files we wish</p>

<p>An Android application permissions specified in a file called  AndroidManifest.xml. This file contains a list of various application-related information such as the minimum Android version required to run the program, the package name, the list of activities (screens in the application visible to the user), services (background processes of the application), and permissions required.</p>

<p>There is no Certificate Authority; instead the developers self-created certificate could sign the applications. Once the application has been uploaded, it goes for verification to Google Bouncer, which is a virtual environment created to check whether an application is malicious or legitimate. Once the check is done, the app then appears in the Play Store. Google does no signing of the application in this case.</p>

<p>We could check the signature of the application and find out who signed the application:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>jarsigner -verify -certs -verbose testing.apk
<span class="c"># or parse out the ASCII content of the CERT.RSA file</span>
<span class="nv">$ </span>unzip testing.apk
<span class="nv">$ </span><span class="nb">cd </span>META-INF
<span class="nv">$ </span>openssl pkcs7 -in CERT.RSA -print_certs -inform DER -out out.cer
<span class="nv">$ </span>cat out.cer</code></pre></div>

<p>The bootloader boots up the kernel, and launches  init , it mounts some of the important directories required for the functioning of the Android system such as  /dev, /sys, and /proc. Also, init takes the configuration for itself from the configuration files  init.rc and  init.[device-name].rc</p>

<p>We can get specific information about the device, by checking the build.prop file at /system location</p>

<p>Once everything is loaded,  init finally loads up a process known as Zygote, which is responsible for loading up the Dalvik Virtual Machines with shared libraries and minimum footprint to enable faster loading of the overall processes.</p>

<p>An Android application is an archive file of the data and resource files created.
while developing the application. The extension of an Android application is .apk, meaning application package, which includes the following files and folders in most cases:</p>

<ul>
  <li>Classes.dex (file)</li>
  <li>AndroidManifest.xml (file)</li>
  <li>META-INF (folder)</li>
  <li>resources.arsc (file)</li>
  <li>res (folder)</li>
  <li>assets (folder)</li>
  <li>lib (folder)</li>
</ul>

<p>An Android application consists of various components: Activities, Services, Broadcast, Receivers, Content providers, and Shared Preferences.
We cant simply unzip the archive package ( .apk ) and get the readable sources.</p>

<p>To convert byte codes to readable files is using a tool called dex2jar:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># open converted jar with JD-GUI to see source code</span>
http://jd.benow.ca/

<span class="c"># converting the .dex file to smali file</span>
https://code.google.com/p/smali/w/list

<span class="c"># decompiling application using Apktool</span>
<span class="nv">$ </span>apktool d WhatsApp.apk

<span class="c"># defining application content provider  AndroidManifest.xml</span>
&lt;provider
android:name<span class="o">=</span><span class="s2">&quot;com.test.example.DataProvider&quot;</span>
android:authorities <span class="o">=</span><span class="s2">&quot;com.test.example.DataProvider&quot;</span>&gt;
&lt;/provider&gt;

<span class="c"># install apk with adb</span>
<span class="nv">$ </span>adb install app.apk</code></pre></div>


      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          



	<img src="https://jivoi.github.io/images/avatar.jpg" class="bio-photo" alt="EK bio photo">

<h3>EK</h3>
<p>Totally not a hacker</p>
<a href="mailto:ekoz@protonmail.com" class="author-widgets" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
<a href="http://twitter.com/jivoi" class="author-widgets" target="_blank"><i class="fa fa-fw fa-tw-square"></i> Twitter</a>





<a href="http://github.com/jivoi" class="author-widgets" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>










        </div>
        <p class="byline"><strong>Learning Android</strong> was published on <time datetime="2015-07-17T00:00:00+03:00">July 17, 2015</time> and last modified on <time datetime="2015-07-17">July 17, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="https://jivoi.github.io/archive/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="https://jivoi.github.io/2016/04/04/move-from-hdd-to-ssd-with-archlinux/" title="Move from HDD to SSD with ArchLinux">Move from HDD to SSD with ArchLinux</a></li>
    
      <li><a href="https://jivoi.github.io/2016/01/22/linux-sysadm-devops-interview-questions/" title="Linux SysAdm/DevOps Interview Questions">Linux SysAdm/DevOps Interview Questions</a></li>
    
      <li><a href="https://jivoi.github.io/2015/12/30/archlinux-installation-guide/" title="ArchLinux Installation Guide">ArchLinux Installation Guide</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://jivoi.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="https://jivoi.github.io/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-64125092-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'http-jivoi-github-io'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    // (function() {
    //     var dsq = document.createElement('script');
    //     dsq.type = 'text/javascript'; dsq.async = true;
    //     dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    //     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    // })();

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//http-jivoi-github-io.disqus.com/embed.js';
    s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script');
        s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());



</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



	        

</body>
</html>
